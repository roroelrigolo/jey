{% extends '/front/base.html.twig' %}

{% block title %}Jey{% endblock %}

{% block javascripts %}

{% endblock %}

{% block body %}
    <div class="container grid grid-cols-12 gap-x-4 mx-auto px-40 my-10">
        <div class="col-span-6 flex px-1">
            <div class="w-1/4 pe-2">
                {% if product.images|length < 4 %}
                    {% for image in product.images|slice(1) %}
                        <div class="">
                            <img class="w-full object-fit-cover rounded" height="135" style="margin-bottom: 15px" src="/upload/product/img/{{ image.url }}">
                        </div>
                    {% endfor %}
                {% else %}
                    {% for image in product.images|slice(1,3) %}
                        {% if loop.index == 3 and product.images|length > 4 %}
                            <div class="relative">
                                <p class="absolute text-xl font-bold rounded text-fullwhite bg-black bg-opacity-50 w-full h-full flex justify-center items-center">+{{ product.images|length-4 }}</p>
                                <img class="w-100 object-fit-cover rounded" height="135" src="/upload/product/img/{{ image.url }}">
                            </div>
                        {% else %}
                            <div class="">
                                <img class="w-full object-fit-cover rounded" height="135" style="margin-bottom: 15px" src="/upload/product/img/{{ image.url }}">
                            </div>
                        {% endif %}
                    {% endfor %}
                {% endif %}

            </div>
            <div class="w-3/4">
                {% for image in product.images|slice(0,1) %}
                    <img class="w-full object-cover rounded" height="600" src="/upload/product/img/{{ image.url }}">
                {% endfor %}
            </div>
        </div>
        <div class="col-span-6 flex flex-col gap-y-2">
            <div class="bg-fullwhite p-4 flex gap-x-4 items-center">
                <div class="rounded-full bg-primary w-[50px] h-[50px]"></div>
                <div>
                    <p>{{ component('Global:LinkUser', { pseudo: product.user.pseudo }) }} - 421⭐</p>
                    <p><i class="fa-light fa-location-dot"></i> {{ product.user.location.title }}</p>
                    {# <p><i class="fa-light fa-clock"></i></i> Conneté il y a 27 minutes</p> #}
                </div>
            </div>
            <div class="bg-fullwhite flex flex-col gap-y-4 p-4">
                <div>
                    <div class="flex justify-between">
                        <p class="text-3xl">{{ product.title }}</p>
                        <p class="text-4xl text-end">{{ product.price }}€</p>
                    </div>
                    <p class="text-primary">
                        {% if product.player %}
                            {{ product.player.firstName }} {{ product.player.lastName }},
                        {% endif %}
                        {{ product.team.title }},
                        {{ product.league.title }}
                    </p>
                </div>

                <div>
                    <p class="text-base">Description</p>
                    <p>{{ product.description }}</p>
                </div>

                <div>
                    <p class="text-base">Détails</p>
                    <p>{{ product.brand.title }}</p>
                    <p>Taille {{ product.size }}</p>
                    <p>{{ product.conditionnement }}</p>
                    <p>{{ product.type }}</p>
                </div>

                {% if app.user %}
                    {% if app.user.id != product.user.id %}
                        <div class="flex flex-col justify-center gap-y-4 w-1/2 mx-auto">
                            <form class="w-full" method="post" enctype="multipart/form-data">
                                <input type="hidden" class="hidden" id="action" name="action" value="book">
                                {{ component('Global:Button', { tag: 'input', text: 'Réserver', class: 'secondary' }) }}
                            </form>
                            <form class="w-full" method="post">
                                <input type="hidden" class="hidden" id="action" name="action" value="contact">
                                {{ component('Global:Button', { tag: 'input', text: 'Contacter le vendeur', class: 'primary' }) }}
                            </form>
                        </div>
                    {% endif %}
                {% else %}
                    <div class="flex flex-col justify-center gap-y-4 w-1/2 mx-auto">
                        {{ component('Global:Button', { tag: 'a', text: 'Réserver', route: 'app_front_home', class: 'secondary' }) }}
                        {{ component('Global:Button', { tag: 'a', text: 'Contacter le vendeur', route: 'app_front_home', class: 'primary' }) }}
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    {% set title = product.user.products|length~' autres annonces de <i class="text-primary">@'~product.user.pseudo~'</i>' %}
    {{ component('Front:Product:ProductListing', { title: title, listing : 'userProducts', user_id : product.user.id }) }}

{% endblock %}

